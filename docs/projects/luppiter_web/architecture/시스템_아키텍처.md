# Luppiter Web 시스템 아키텍처

## 개요

Luppiter Web의 핵심 기능인 **이벤트 상황관리**와 **인시던트 상황관리** 시스템 구조.

---

## 시스템 구조

```
┌─────────────────────────────────────────────────────────────┐
│                    Luppiter Web                             │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────────────┐         ┌──────────────────┐         │
│  │ 이벤트 상황관리   │         │ 인시던트 상황관리 │         │
│  │ (EvtController)  │◄───────►│ (IcdController)   │         │
│  └────────┬─────────┘         └────────┬─────────┘         │
│           │                            │                    │
│  ┌────────▼─────────┐         ┌────────▼─────────┐         │
│  │ EvtService       │         │ IcdService       │         │
│  └────────┬─────────┘         └────────┬─────────┘         │
│           │                            │                    │
│  ┌────────▼─────────┐         ┌────────▼─────────┐         │
│  │ EvtMapper        │         │ IcdMapper        │         │
│  └────────┬─────────┘         └────────┬─────────┘         │
└───────────┼────────────────────────────┼────────────────────┘
            └────────────┬───────────────┘
                         │
            ┌────────────▼────────────┐
            │   Luppiter DB           │
            │  - CMON_EVENT_INFO      │
            │  - CMON_INCIDENT_INFO   │
            │  - CMON_EVENT_RESP_     │
            │    MANAGE_INFO          │
            └─────────────────────────┘
                         ▲
            ┌────────────┴────────────┐
            │  Luppiter Scheduler     │
            │  (이벤트 수집 및 처리)   │
            └─────────────────────────┘
```

---

## 이벤트 상황관리

### 화면
| URL | 설명 |
|-----|------|
| `/view/evt/subEventState` | 이벤트 상황 관리 |
| `/view/evt/subEventStateWindowPopup` | 이벤트 상황 관리(팝업) |
| `/view/evt/subEventExcpState` | 이벤트 예외 관리 |
| `/view/evt/subEventRefineState` | 이벤트 정제 관리 |
| `/view/evt/subEventHistory` | 이벤트 이력 조회 |

### 주요 API

| API | 엔드포인트 | 설명 |
|-----|------------|------|
| 이벤트 목록 조회 | `POST /api/evt/list` | 이벤트 목록 조회 |
| 이벤트 상세 정보 | `POST /api/evt/info` | 이벤트 상세 정보 조회 |
| 1차 인지 처리 | `POST /api/evt/updateOne/{eventType}` | 1차 인지 처리 |
| 인시던트 생성 | `POST /api/evt/createIncident` | 이벤트 기반 인시던트 생성 |
| 이벤트 종료 | `POST /api/evt/updateEventEnd` | 이벤트 종료 처리 |
| 일괄 종료 | `POST /api/evt/endSelectedEventList` | 선택된 이벤트 일괄 종료 |

### 파일 구조
```
src/main/java/com/framework/evt/
├── controller/
│   ├── EvtController.java
│   └── EvtRestController.java
├── service/
│   ├── EvtService.java
│   └── EvtServiceImpl.java
└── mapper/
    └── EvtMapper.java

src/main/webapp/WEB-INF/jsp/evt/
├── subEventState.jsp
├── subEventStateWindowPopup.jsp
├── subEventExcpState.jsp
├── subEventRefineState.jsp
└── subEventHistory.jsp
```

---

## 인시던트 상황관리

### 화면
| URL | 설명 |
|-----|------|
| `/view/icd/subIncidentState` | 인시던트 상황 관리 |
| `/view/icd/subIncidentHistory` | 인시던트 이력 조회 |

### 주요 API

| API | 엔드포인트 | 설명 |
|-----|------------|------|
| 인시던트 목록 조회 | `POST /api/icd/list` | 인시던트 목록 조회 |
| 인시던트 상세 조회 | `POST /api/icd/detail` | 인시던트 상세 정보 조회 |
| 인시던트 정보 수정 | `POST /api/icd/save` | 인시던트 정보 수정 |
| 조치 완료 처리 | `POST /api/icd/end` | 인시던트 조치 완료 처리 |
| 수동 인시던트 생성 | `POST /api/icd/createManualIncident` | 수동 인시던트 생성 |

### 파일 구조
```
src/main/java/com/framework/icd/
├── controller/
│   ├── IcdController.java
│   └── IcdRestController.java
├── service/
│   ├── IcdService.java
│   └── IcdServiceImpl.java
└── mapper/
    └── IcdMapper.java

src/main/webapp/WEB-INF/jsp/icd/
├── subIncidentState.jsp
├── subIncidentHistory.jsp
└── subIncidentStateDetailPopup.jsp
```

---

## 데이터 흐름

```
[외부 시스템] → [Luppiter Scheduler] → [Luppiter DB] → [Luppiter Web]

1. Zabbix/Zenius에서 이벤트 수집
2. Scheduler가 X01_IF_EVENT_* 임시 테이블에 저장
3. Combine Event Job이 CMON_EVENT_INFO로 통합
4. Web에서 이벤트 조회 및 처리
5. 인시던트 생성 시 CMON_INCIDENT_INFO에 저장
```

---

## 주요 테이블

| 테이블 | 설명 |
|--------|------|
| CMON_EVENT_INFO | 이벤트 메인 테이블 |
| CMON_INCIDENT_INFO | 인시던트 메인 테이블 |
| CMON_EVENT_RESP_MANAGE_INFO | 이벤트 대응관리 정보 |
| X01_IF_EVENT_DATA | Zabbix 임시 테이블 |
| X01_IF_EVENT_ZENIUS | Zenius 임시 테이블 |

---

**최종 업데이트**: 2026-01-30
